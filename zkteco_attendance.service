[Unit]
Description=ZKTeco Attendance Synchronization Service
Documentation=https://github.com/your-org/driver-zkteco-service
After=network-online.target
Wants=network-online.target

[Service]
Type=simple
ExecStart=/home/frederick/projets/driver-zkteco-service/venv/bin/python3 /home/frederick/projets/driver-zkteco-service/zkteco_service.py
Restart=on-failure
RestartSec=30
StartLimitInterval=350
StartLimitBurst=10

# User and group
User=root
Group=root

# Working directory
WorkingDirectory=/home/frederick/projets/driver-zkteco-service

# Logging
StandardOutput=append:/home/frederick/projets/driver-zkteco-service/zkteco_attendance.log
StandardError=append:/home/frederick/projets/driver-zkteco-service/zkteco_attendance_error.log
SyslogIdentifier=zkteco-service

# Watchdog - service will notify systemd every 60s
WatchdogSec=120

# Security hardening
NoNewPrivileges=true
PrivateTmp=true
ProtectSystem=strict
ProtectHome=read-only
ReadWritePaths=/home/frederick/projets/driver-zkteco-service

# Resource limits
LimitNOFILE=65535
MemoryMax=512M
CPUQuota=50%

# Graceful shutdown
TimeoutStopSec=30
KillMode=mixed
KillSignal=SIGTERM

# Environment
Environment="PYTHONUNBUFFERED=1"
EnvironmentFile=-/home/frederick/projets/driver-zkteco-service/.env

[Install]
WantedBy=multi-user.target